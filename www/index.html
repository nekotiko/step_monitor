<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="components/loader.js"></script>
    <script src="lib/angular/angular.min.js"></script>
    <script src="lib/onsenui/js/onsenui.min.js"></script>
    <script src="lib/onsenui/js/angular-onsenui.min.js"></script>

    <link rel="stylesheet" href="components/loader.css">
    <link rel="stylesheet" href="lib/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="lib/onsenui/css/onsen-css-components.css">
    <link rel="stylesheet" href="css/style.css">
    <script>
        ons.bootstrap('StepMonitor', []);
    </script>

    <script src="components/services/BLEService.js"></script>
    <script src="components/services/DBService.js"></script>

    <script src="components/devices/devices.js"></script>
    <script src="components/monitor/monitor.js"></script>
    <script src="components/records/records.js"></script>

    <script>
        angular.module('StepMonitor')
            .controller('AppController', function($scope, $DBService) {
                this.load = function(page) {
                    $scope.splitter.content.load(page);
                    $scope.splitter.left.close();
                };

                this.toggle = function() {
                    $scope.splitter.left.toggle();
                };

                $DBService.initialize_db();




            });

        ons.ready(function() {
            console.log("Onsen UI is ready!");
        });
    </script>

</head>
<body>

<ons-splitter ng-controller="AppController as app" var="splitter">
    <ons-splitter-side side="left" width="220px" collapse swipeable>
        <ons-page>
            <ons-list>
                <ons-list-item ng-click="app.load('devices.html')" tappable>
                    Devices
                </ons-list-item>
                <ons-list-item ng-click="app.load('monitor.html')" tappable>
                    Monitor
                </ons-list-item>
                <ons-list-item ng-click="app.load('records.html')" tappable>
                    Records
                </ons-list-item>
            </ons-list>
        </ons-page>
    </ons-splitter-side>
    <ons-splitter-content page="index.html"></ons-splitter-content>
</ons-splitter>

<ons-template id="index.html">
    <ons-page>
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button ng-click="app.toggle()">
                    <ons-icon icon="md-menu"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">
                Main
            </div>
        </ons-toolbar>
        <p style="text-align: center; opacity: 0.6; padding-top: 20px;">
            Swipe right to open the menu!
        </p>
    </ons-page>
</ons-template>


<ons-template id="devices.html">
    <ons-page  ons-show="app.title = 'Devices'" ng-controller="DevicesController as dc" >
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button ng-click="app.toggle()">
                    <ons-icon icon="md-menu"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">
                Device - [{{selectedDevice.name}}]
            </div>
        </ons-toolbar>
        <div class="content" style="text-align: center">
            <ons-list id="device_list">
                <ons-list-item tappable ng-repeat="item in availableDevices" ng-click="connectDevice(item)">{{item.name}}</ons-list-item>
            </ons-list>
            <ons-button ng-click="startMonitoring()" ng-disabled="!selectedDevice">Start Data</ons-button>
            <ons-button ng-click="disconnect()" ng-disabled="!selectedDevice">Disconnect</ons-button>
        </div>
    </ons-page>
</ons-template>

<ons-template id="monitor.html">
    <ons-page   ng-controller="MonitorController as monitor">
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button ng-click="app.toggle()">
                    <ons-icon icon="md-menu"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">
                Monitor - []
            </div>
        </ons-toolbar>
        <div class="content" style="text-align: center">
            <div class="soles_container">
                <img src="images/soles.png" class="soles_fg" >
                <div class="soles_bk">
                    <div class="left_sole_container">
                        <div id="l_thumb" style="height:15%;background-color: rgb({{LEFT_FEET.T}}, 255,{{LEFT_FEET.T}});"></div>
                        <div id="l_sole"  class="zone" style="height:35%; background-color:  rgb({{LEFT_FEET.S}}, 255, {{LEFT_FEET.S}})"></div>
                        <div id="l_instep"class="zone" style="height:24.75%; background-color: rgb({{LEFT_FEET.I}}, 255, {{LEFT_FEET.I}})"></div>
                        <div id="l_heel"  class="zone" style="height:25.25%; background-color: rgb({{LEFT_FEET.H}}, 255, {{LEFT_FEET.H}})"></div>
                    </div>

                    <div class="right_sole_container">
                        <div id="r_thumb" class="zone" style="height:15%;background-color: rgb({{RIGHT_FEET.T}}, 255, {{RIGHT_FEET.T}});"></div>
                        <div id="r_sole"  class="zone" style="height:35%; background-color:  rgb({{RIGHT_FEET.S}}, 255, {{RIGHT_FEET.S}})"></div>
                        <div id="r_instep"class="zone" style="height:24.75%; background-color: rgb({{RIGHT_FEET.I}}, 255, {{RIGHT_FEET.I}})"></div>
                        <div id="r_heel"  class="zone" style="height:25.25%; background-color: rgb({{RIGHT_FEET.H}}, 255, {{RIGHT_FEET.H}})"></div>

                    </div>
                </div>
            </div>
        </div>
    </ons-page>
</ons-template>

<ons-template id="records.html">
    <ons-page  ons-show="load_records()" ng-controller="RecordsController as rc">
        <ons-toolbar>
            <div class="left">
                <ons-toolbar-button ng-click="app.toggle()">
                    <ons-icon icon="md-menu"></ons-icon>
                </ons-toolbar-button>
            </div>
            <div class="center">
                Records - [{{selectElem.name}}]
            </div>
        </ons-toolbar>
        <div class="content" style="text-align: center" >
            <ons-button ng-click="startRecording()" ng-disabled="recording">Start Recording</ons-button>
            <ons-button ng-click="stopRecording()" ng-disabled="!recording">Stop</ons-button>
            <ons-button ng-click="deleteRecord()" ng-disabled="!selectElem.id">Delete</ons-button>
            <ons-button ng-click="sentRecord()" ng-disabled="!selectElem.id">Send</ons-button>

            <ons-list id="record_list">
                <ons-list-item tappable ng-repeat="item in availableRecords" ng-click="select_element(item)"
                               ng-style=""> {{item.name}}</ons-list-item>
            </ons-list>

        </div>
    </ons-page>
</ons-template>
</body>

</html>
